<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <form>
        <button>Click me</button>
    </form>
    <script>

function isWebBluetoothEnabled() {
    if (!navigator.bluetooth) {
      console.log('Web Bluetooth API is not available in this browser!')
      return false
    }

    return true
  }

  function getDeviceInfo() {
    let options = {
      acceptAllDevices: true,
  optionalServices: ['battery_service']      
    }

    console.log('Requesting Bluetooth Device...')
    navigator.bluetooth.requestDevice({
  acceptAllDevices: true,
})
.then(device => { /* â€¦ */ })
.catch(error => { console.error(error); });

    navigator.bluetooth.requestDevice(options).then(device => {
      console.log('> Name: ' + device.name)
      console.log('> id: ' + device.id)
      console.log('> Connected:        ' + device.gatt.connected)
      return device.gatt.connect();
    })
    .then(device => {
    console.log('Connecting to GATT Server...');
    return device;
    return device.gatt;
    return device.gatt.connect();
  })
  .then(server => {
    console.log('Getting Battery Service...');
    return server.getPrimaryService('battery_service');
  })
  .then(service => {
    console.log('Getting Battery Level Characteristic...');
    return service.getCharacteristic('battery_level');
  })
  .then(characteristic => {
    console.log('Reading Battery Level...');
    return characteristic.readValue();
  })
  .then(value => {
    let batteryLevel = value.getUint8(0);
    console.log('> Battery Level is ' + batteryLevel + '%');
  })
    .catch(error => {
      console.log('Argh! ' + error)
    })
  }

  document.querySelector('form').addEventListener('submit', function(event) {
    event.stopPropagation()
    event.preventDefault()

    if (isWebBluetoothEnabled()) {
      getDeviceInfo()
    }
  })
    </script>
</body>
</html>